correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, GrossRevenue) %>% filter(GrossRevenue == min(GrossRevenue)) %>% summarise(AvgRev = mean(GrossRevenue)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, GrossRevenue) %>% filter(GrossRevenue == min(GrossRevenue)) %>% summarise(AvgRev = mean(GrossRevenue)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, GrossRevenue) %>% filter(GrossRevenue == min(GrossRevenue)) %>% summarise(AvgRev = mean(GrossRevenue)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% select(Year, AggMnA) %>% unique() %>% arrange(Year) %>% select(AggMnA))
correlRanks$GDP <- gdpDF$GDP
names(correlRanks) = c("Year",
"Rank1.Rev", "Rank1.Rev.Lawyer", "Rank1.NOI.Lawyer", "Rank1.NOI.EqPart",
"Rank2.Rev", "Rank2.Rev.Lawyer", "Rank2.NOI.Lawyer", "Rank2.NOI.EqPart",
"Rank10.Rev", "Rank10.Rev.Lawyer", "Rank10.NOI.Lawyer", "Rank10.NOI.EqPart",
"Rank50.Rev", "Rank50.Rev.Lawyer", "Rank50.NOI.Lawyer", "Rank50.NOI.EqPart",
"Rank100.Rev", "Rank100.Rev.Lawyer", "Rank100.NOI.Lawyer", "Rank100.NOI.EqPart",
"AggMnA", "GDP")
corrDf = df %>% select(Lawyers, Leverage, GrossRev, NOI, IPORevenue,
EquityRevenue, MnARevenue, Rev.Lawyer, NOI.Lawyer, NOI.eqPart) %>% as.data.frame()
names(corrDf) = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart")
corrDf = df %>% select(Lawyers, Leverage, GrossRev, NOI, IPORevenue,
EquityRevenue, MnARevenue, Rev.Lawyer, NOI.Lawyer, NOI.eqPart) %>% as.data.frame()
names(corrDf) = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart")
corrMat = cor(corrDf)
levelplot(corrMat, pretty=TRUE, names.attr = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart"))
correlRanks = as.data.frame(unique(sort(df$Year)))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, GrossRev) %>% filter(GrossRevenue == min(GrossRevenue)) %>% summarise(AvgRev = mean(GrossRevenue)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
corrDf = df %>% select(Lawyers, Leverage, GrossRev, NOI, IPORevenue,
EquityRevenue, MnARevenue, Rev.Lawyer, NOI.Lawyer, NOI.eqPart) %>% as.data.frame()
names(corrDf) = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart")
corrMat = cor(corrDf)
levelplot(corrMat, pretty=TRUE, names.attr = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart"))
# Correlations
correlRanks = as.data.frame(unique(sort(df$Year)))
# Top 1
# GrossRev
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, GrossRev) %>% filter(GrossRevenue == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRevenue)) %>% arrange(Year) %>% select(AvgRev))
# Rev/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
# NOI/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
# NOI/EqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
# Top 2
# GrossRev
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, GrossRev) %>% filter(GrossRevenue == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRevenue)) %>% arrange(Year) %>% select(AvgRev))
# Rev/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
# NOI/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
# NOI/EqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
# Top 10
# GrossRev
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, GrossRev) %>% filter(GrossRevenue == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRevenue)) %>% arrange(Year) %>% select(AvgRev))
# Rev/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
# NOI/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
# NOI/EqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
# Top 50
# GrossRev
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, GrossRev) %>% filter(GrossRevenue == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRevenue)) %>% arrange(Year) %>% select(AvgRev))
# Rev/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
# NOI/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
# NOI/EqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
# Top 100
# GrossRev
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, GrossRev) %>% filter(GrossRevenue == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRevenue)) %>% arrange(Year) %>% select(AvgRev))
# Rev/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
# NOI/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
# NOI/EqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
# Aggregated M&A
correlRanks = cbind(correlRanks, df %>% select(Year, AggMnA) %>% unique() %>% arrange(Year) %>% select(AggMnA))
corrDf = df %>% select(Lawyers, Leverage, GrossRev, NOI, IPORevenue,
EquityRevenue, MnARevenue, Rev.Lawyer, NOI.Lawyer, NOI.eqPart) %>% as.data.frame()
names(corrDf) = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart")
corrMat = cor(corrDf)
levelplot(corrMat, pretty=TRUE, names.attr = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart"))
correlRanks = as.data.frame(unique(sort(df$Year)))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, GrossRev) %>% filter(GrossRevenue == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRevenue)) %>% arrange(Year) %>% select(AvgRev))
corrDf = df %>% select(Lawyers, Leverage, GrossRev, NOI, IPORevenue,
EquityRevenue, MnARevenue, Rev.Lawyer, NOI.Lawyer, NOI.eqPart) %>% as.data.frame()
names(corrDf) = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart")
corrMat = cor(corrDf)
levelplot(corrMat, pretty=TRUE, names.attr = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart"))
correlRanks = as.data.frame(unique(sort(df$Year)))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, GrossRev) %>% filter(GrossRevenue == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
corrDf = df %>% select(Lawyers, Leverage, GrossRev, NOI, IPORevenue,
EquityRevenue, MnARevenue, Rev.Lawyer, NOI.Lawyer, NOI.eqPart) %>% as.data.frame()
names(corrDf) = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart")
corrMat = cor(corrDf)
levelplot(corrMat, pretty=TRUE, names.attr = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart"))
correlRanks = as.data.frame(unique(sort(df$Year)))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, GrossRev) %>% filter(GrossRevenue == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% select(Year, AggMnA) %>% unique() %>% arrange(Year) %>% select(AggMnA))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% select(Year, AggMnA) %>% unique() %>% arrange(Year) %>% select(AggMnA))
corrDf = df %>% select(Lawyers, Leverage, GrossRev, NOI, IPORevenue,
EquityRevenue, MnARevenue, Rev.Lawyer, NOI.Lawyer, NOI.eqPart) %>% as.data.frame()
names(corrDf) = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart")
corrMat = cor(corrDf)
levelplot(corrMat, pretty=TRUE, names.attr = c("Lawyers", "Leverage", "Rev", "NOI", "IPO", "Equity", "MnA", "Rev/Law", "NOI/Law", "NOI/EqPart"))
correlRanks = as.data.frame(unique(sort(df$Year)))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(1, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(2, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(10, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(50, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(100, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
correlRanks = cbind(correlRanks, df %>% select(Year, AggMnA) %>% unique() %>% arrange(Year) %>% select(AggMnA))
correlRanks$GDP <- gdpDF$GDP
names(correlRanks) = c("Year",
"Rank1.Rev", "Rank1.Rev.Lawyer", "Rank1.NOI.Lawyer", "Rank1.NOI.EqPart",
"Rank2.Rev", "Rank2.Rev.Lawyer", "Rank2.NOI.Lawyer", "Rank2.NOI.EqPart",
"Rank10.Rev", "Rank10.Rev.Lawyer", "Rank10.NOI.Lawyer", "Rank10.NOI.EqPart",
"Rank50.Rev", "Rank50.Rev.Lawyer", "Rank50.NOI.Lawyer", "Rank50.NOI.EqPart",
"Rank100.Rev", "Rank100.Rev.Lawyer", "Rank100.NOI.Lawyer", "Rank100.NOI.EqPart",
"AggMnA", "GDP")
lessThan100 = df %>% group_by(Year) %>% summarise(lessThan100 = n()<=100) %>% filter (lessThan100 == TRUE) %>% select(Year) %>% as.list()
greaterThan100 = df %>% group_by(Year) %>% summarise(lessThan100 = n()>100) %>% filter (lessThan100 == TRUE) %>% select(Year) %>% as.list()
correlRanks[which(correlRanks$Year %in% lessThan100$Year), c("Rank100.Rev", "Rank100.Rev.Lawyer", "Rank100.NOI.Lawyer", "Rank100.NOI.EqPart")] = NA
correlations.Rev = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.Rev = cbind(correlations.Rev, NA, NA)
names(correlations.Rev) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.Rev = correlRanks %>% select(Rank1.Rev, Rank2.Rev, Rank10.Rev, Rank50.Rev, Rank100.Rev, AggMnA, GDP)
correlations.Rev.Lawyer = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.Rev.Lawyer = cbind(correlations.Rev.Lawyer, NA, NA)
names(correlations.Rev.Lawyer) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.Rev.Lawyer = correlRanks %>% select(Rank1.Rev.Lawyer, Rank2.Rev.Lawyer, Rank10.Rev.Lawyer, Rank50.Rev.Lawyer, Rank100.Rev.Lawyer, AggMnA, GDP)
correlations.NOI.Lawyer = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.NOI.Lawyer = cbind(correlations.NOI.Lawyer, NA, NA)
names(correlations.NOI.Lawyer) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.NOI.Lawyer = correlRanks %>% select(Rank1.NOI.Lawyer, Rank2.NOI.Lawyer, Rank10.NOI.Lawyer, Rank50.NOI.Lawyer, Rank100.NOI.Lawyer, AggMnA, GDP)
correlations.NOI.EqPart = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.NOI.EqPart = cbind(correlations.NOI.EqPart, NA, NA)
names(correlations.NOI.EqPart) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.NOI.EqPart = correlRanks %>% select(Rank1.NOI.EqPart, Rank2.NOI.EqPart, Rank10.NOI.EqPart, Rank50.NOI.EqPart, Rank100.NOI.EqPart, AggMnA, GDP)
for(i in 1:5){
correlations.Rev[i,1] = cor(cbind(dfRank.Rev[,i], dfRank.Rev$AggMnA) %>% na.omit())[2, 1]
correlations.Rev[i,2] = cor(cbind(dfRank.Rev[,i], dfRank.Rev$GDP) %>% na.omit())[2, 1]
correlations.Rev.Lawyer[i,1] = cor(cbind(dfRank.Rev.Lawyer[,i], dfRank.Rev.Lawyer$AggMnA) %>% na.omit())[2, 1]
correlations.Rev.Lawyer[i,2] = cor(cbind(dfRank.Rev.Lawyer[,i], dfRank.Rev.Lawyer$GDP) %>% na.omit())[2, 1]
correlations.NOI.Lawyer[i,1] = cor(cbind(dfRank.NOI.Lawyer[,i], dfRank.NOI.Lawyer$AggMnA) %>% na.omit())[2, 1]
correlations.NOI.Lawyer[i,2] = cor(cbind(dfRank.NOI.Lawyer[,i], dfRank.NOI.Lawyer$GDP) %>% na.omit())[2, 1]
correlations.NOI.EqPart[i,1] = cor(cbind(dfRank.NOI.EqPart[,i], dfRank.NOI.EqPart$AggMnA) %>% na.omit())[2, 1]
correlations.NOI.EqPart[i,2] = cor(cbind(dfRank.NOI.EqPart[,i], dfRank.NOI.EqPart$GDP) %>% na.omit())[2, 1]
}
colnames(correlations.Rev) <- c("AggMnA", "GDP")
colnames(correlations.Rev.Lawyer) <- c("AggMnA", "GDP")
colnames(correlations.NOI.Lawyer) <- c("AggMnA", "GDP")
colnames(correlations.NOI.EqPart) <- c("AggMnA", "GDP")
correlations.Rev
correlRanks = as.data.frame(unique(sort(df$Year)))
for (n in c(1,2,10,50,100)) {
# Top 1
# GrossRev
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
# Rev/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
# NOI/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
# NOI/EqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
}
names(df)
correlRanks = as.data.frame(unique(sort(df$Year)))
n=1
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, Rev.Lawyer) %>% filter(Rev.Lawyer == min(Rev.Lawyer)) %>% summarise(AvgRev.Lawyer = mean(Rev.Lawyer)) %>% arrange(Year) %>% select(AvgRev.Lawyer))
correlRanks = as.data.frame(unique(sort(df$Year)))
for (n in c(1,2,10,50,100)) {
# Top n
# GrossRev
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
# Rev/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev.Lawyer) %>% filter(GrossRev.Lawyer == min(GrossRev.Lawyer)) %>% summarise(AvgGrossRev.Lawyer = mean(GrossRev.Lawyer)) %>% arrange(Year) %>% select(AvgGrossRev.Lawyer))
# Rev/eqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev.eqPart) %>% filter(GrossRev.eqPart == min(GrossRev.eqPart)) %>% summarise(AvgGrossRev.eqPart = mean(GrossRev.eqPart)) %>% arrange(Year) %>% select(AvgGrossRev.eqPart))
# NOI
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI) %>% filter(NOI == min(NOI)) %>% summarise(AvgNOI = mean(NOI)) %>% arrange(Year) %>% select(AvgNOI))
# NOI/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
# NOI/EqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
}
correlRanks = cbind(correlRanks, df %>% select(Year, AggMnA) %>% unique() %>% arrange(Year) %>% select(AggMnA))
correlRanks$GDP <- gdpDF$GDP
names(correlRanks) = c("Year",
"Rank1.Rev", "Rank1.Rev.Lawyer", "Rank1.NOI.Lawyer", "Rank1.NOI.EqPart",
"Rank2.Rev", "Rank2.Rev.Lawyer", "Rank2.NOI.Lawyer", "Rank2.NOI.EqPart",
"Rank10.Rev", "Rank10.Rev.Lawyer", "Rank10.NOI.Lawyer", "Rank10.NOI.EqPart",
"Rank50.Rev", "Rank50.Rev.Lawyer", "Rank50.NOI.Lawyer", "Rank50.NOI.EqPart",
"Rank100.Rev", "Rank100.Rev.Lawyer", "Rank100.NOI.Lawyer", "Rank100.NOI.EqPart",
"AggMnA", "GDP")
lessThan100 = df %>% group_by(Year) %>% summarise(lessThan100 = n()<=100) %>% filter (lessThan100 == TRUE) %>% select(Year) %>% as.list()
greaterThan100 = df %>% group_by(Year) %>% summarise(lessThan100 = n()>100) %>% filter (lessThan100 == TRUE) %>% select(Year) %>% as.list()
correlRanks[which(correlRanks$Year %in% lessThan100$Year), c("Rank100.Rev", "Rank100.Rev.Lawyer", "Rank100.NOI.Lawyer", "Rank100.NOI.EqPart")] = NA
names(correlRanks)
correlRanks = as.data.frame(unique(sort(df$Year)))
for (n in c(1,2,10,50,100)) {
# Top n
# GrossRev
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
# Rev/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev.Lawyer) %>% filter(GrossRev.Lawyer == min(GrossRev.Lawyer)) %>% summarise(AvgGrossRev.Lawyer = mean(GrossRev.Lawyer)) %>% arrange(Year) %>% select(AvgGrossRev.Lawyer))
# Rev/eqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev.eqPart) %>% filter(GrossRev.eqPart == min(GrossRev.eqPart)) %>% summarise(AvgGrossRev.eqPart = mean(GrossRev.eqPart)) %>% arrange(Year) %>% select(AvgGrossRev.eqPart))
# NOI
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI) %>% filter(NOI == min(NOI)) %>% summarise(AvgNOI = mean(NOI)) %>% arrange(Year) %>% select(AvgNOI))
# NOI/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
# NOI/EqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
}
correlRanks = cbind(correlRanks, df %>% select(Year, AggMnA) %>% unique() %>% arrange(Year) %>% select(AggMnA))
correlRanks$GDP <- gdpDF$GDP
lessThan100 = df %>% group_by(Year) %>% summarise(lessThan100 = n()<=100) %>% filter (lessThan100 == TRUE) %>% select(Year) %>% as.list()
greaterThan100 = df %>% group_by(Year) %>% summarise(lessThan100 = n()>100) %>% filter (lessThan100 == TRUE) %>% select(Year) %>% as.list()
correlRanks[which(correlRanks$Year %in% lessThan100$Year), c("Rank100.Rev", "Rank100.Rev.Lawyer", "Rank100.NOI.Lawyer", "Rank100.NOI.EqPart")] = NA
names(correlRanks)
correlRanks = as.data.frame(unique(sort(df$Year)))
names(correlRanks) = c("Year")
correlRanks
correlRanks = as.data.frame(unique(sort(df$Year)))
names(correlRanks)[1] <- "Year"
correlRanks
n
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
names(correlRanks)[ncol(correlRanks)-1]
names(correlRanks)[ncol(correlRanks)]
correlRanks = as.data.frame(unique(sort(df$Year)))
names(correlRanks)[1] <- "Year"
for (n in c(1,2,10,50,100)) {
# Top n
# GrossRev
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev) %>% filter(GrossRev == min(GrossRev)) %>% summarise(AvgRev = mean(GrossRev)) %>% arrange(Year) %>% select(AvgRev))
names(correlRanks)[ncol(correlRanks)] <- paste("Rank",n,".Rev", sep="")
# Rev/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev.Lawyer) %>% filter(GrossRev.Lawyer == min(GrossRev.Lawyer)) %>% summarise(AvgGrossRev.Lawyer = mean(GrossRev.Lawyer)) %>% arrange(Year) %>% select(AvgGrossRev.Lawyer))
names(correlRanks)[ncol(correlRanks)] <- paste("Rank",n,".Rev.Lawyer", sep="")
# Rev/eqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, GrossRev.eqPart) %>% filter(GrossRev.eqPart == min(GrossRev.eqPart)) %>% summarise(AvgGrossRev.eqPart = mean(GrossRev.eqPart)) %>% arrange(Year) %>% select(AvgGrossRev.eqPart))
names(correlRanks)[ncol(correlRanks)] <- paste("Rank",n,".Rev.EqPart", sep="")
# NOI
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI) %>% filter(NOI == min(NOI)) %>% summarise(AvgNOI = mean(NOI)) %>% arrange(Year) %>% select(AvgNOI))
names(correlRanks)[ncol(correlRanks)] <- paste("Rank",n,".NOI", sep="")
# NOI/Lawyer
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI.Lawyer) %>% filter(NOI.Lawyer == min(NOI.Lawyer)) %>% summarise(AvgNOI.Lawyer = mean(NOI.Lawyer)) %>% arrange(Year) %>% select(AvgNOI.Lawyer))
names(correlRanks)[ncol(correlRanks)] <- paste("Rank",n,".NOI.Lawyer", sep="")
# NOI/EqPart
correlRanks = cbind(correlRanks, df %>% group_by(Year) %>% top_n(n, NOI.eqPart) %>% filter(NOI.eqPart == min(NOI.eqPart)) %>% summarise(AvgNOI.EqPart = mean(NOI.eqPart)) %>% arrange(Year) %>% select(AvgNOI.EqPart))
names(correlRanks)[ncol(correlRanks)] <- paste("Rank",n,".NOI.EqPart", sep="")
}
correlRanks
correlRanks = cbind(correlRanks, df %>% select(Year, AggMnA) %>% unique() %>% arrange(Year) %>% select(AggMnA))
correlRanks$GDP <- gdpDF$GDP
correlRanks
grepl(names(correlRank), "Rank100")
grepl(names(correlRanks), "Rank100")
names(correlRanks)
grepl("Rank100", names(correlRanks))
lessThan100 = df %>% group_by(Year) %>% summarise(lessThan100 = n()<=100) %>% filter (lessThan100 == TRUE) %>% select(Year) %>% as.list()
greaterThan100 = df %>% group_by(Year) %>% summarise(lessThan100 = n()>100) %>% filter (lessThan100 == TRUE) %>% select(Year) %>% as.list()
correlRanks[which(correlRanks$Year %in% lessThan100$Year), grepl("Rank100", names(correlRanks))] = NA
correlations.Rev = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.Rev = cbind(correlations.Rev, NA, NA)
names(correlations.Rev) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.Rev = correlRanks %>% select(Rank1.Rev, Rank2.Rev, Rank10.Rev, Rank50.Rev, Rank100.Rev, AggMnA, GDP)
correlations.Rev = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.Rev = cbind(correlations.Rev, NA, NA)
names(correlations.Rev) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.Rev = correlRanks %>% select(Rank1.Rev, Rank2.Rev, Rank10.Rev, Rank50.Rev, Rank100.Rev, AggMnA, GDP)
correlations.Rev.Lawyer = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.Rev.Lawyer = cbind(correlations.Rev.Lawyer, NA, NA)
names(correlations.Rev.Lawyer) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.Rev.Lawyer = correlRanks %>% select(Rank1.Rev.Lawyer, Rank2.Rev.Lawyer, Rank10.Rev.Lawyer, Rank50.Rev.Lawyer, Rank100.Rev.Lawyer, AggMnA, GDP)
correlations.Rev.EqPart = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.Rev.EqPart = cbind(correlations.Rev.EqPart, NA, NA)
names(correlations.Rev.EqPart) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.Rev.EqPart = correlRanks %>% select(Rank1.Rev.EqPart, Rank2.Rev.EqPart, Rank10.Rev.EqPart, Rank50.Rev.EqPart, Rank100.Rev.EqPart, AggMnA, GDP)
correlations.NOI = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.NOI = cbind(correlations.NOI, NA, NA)
names(correlations.NOI) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.NOI = correlRanks %>% select(Rank1.NOI, Rank2.NOI, Rank10.NOI, Rank50.NOI, Rank100.NOI, AggMnA, GDP)
correlations.NOI.Lawyer = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.NOI.Lawyer = cbind(correlations.NOI.Lawyer, NA, NA)
names(correlations.NOI.Lawyer) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.NOI.Lawyer = correlRanks %>% select(Rank1.NOI.Lawyer, Rank2.NOI.Lawyer, Rank10.NOI.Lawyer, Rank50.NOI.Lawyer, Rank100.NOI.Lawyer, AggMnA, GDP)
correlations.NOI.EqPart = data.frame(row.names = c("Rank 1", "Rank 2", "Rank 10", "Rank 50", "Rank 100"))
correlations.NOI.EqPart = cbind(correlations.NOI.EqPart, NA, NA)
names(correlations.NOI.EqPart) = c("Correl_Rev_AggMA", "Correl_Rev_GDP")
dfRank.NOI.EqPart = correlRanks %>% select(Rank1.NOI.EqPart, Rank2.NOI.EqPart, Rank10.NOI.EqPart, Rank50.NOI.EqPart, Rank100.NOI.EqPart, AggMnA, GDP)
for(i in 1:5){
correlations.Rev[i,1] = cor(cbind(dfRank.Rev[,i], dfRank.Rev$AggMnA) %>% na.omit())[2, 1]
correlations.Rev[i,2] = cor(cbind(dfRank.Rev[,i], dfRank.Rev$GDP) %>% na.omit())[2, 1]
correlations.Rev.Lawyer[i,1] = cor(cbind(dfRank.Rev.Lawyer[,i], dfRank.Rev.Lawyer$AggMnA) %>% na.omit())[2, 1]
correlations.Rev.Lawyer[i,2] = cor(cbind(dfRank.Rev.Lawyer[,i], dfRank.Rev.Lawyer$GDP) %>% na.omit())[2, 1]
correlations.Rev.EqPart[i,1] = cor(cbind(dfRank.Rev.EqPart[,i], dfRank.Rev.EqPart$AggMnA) %>% na.omit())[2, 1]
correlations.Rev.EqPart[i,2] = cor(cbind(dfRank.Rev.EqPart[,i], dfRank.Rev.EqPart$GDP) %>% na.omit())[2, 1]
correlations.NOI[i,1] = cor(cbind(dfRank.NOI[,i], dfRank.NOI$AggMnA) %>% na.omit())[2, 1]
correlations.NOI[i,2] = cor(cbind(dfRank.NOI[,i], dfRank.NOI$GDP) %>% na.omit())[2, 1]
correlations.NOI.Lawyer[i,1] = cor(cbind(dfRank.NOI.Lawyer[,i], dfRank.NOI.Lawyer$AggMnA) %>% na.omit())[2, 1]
correlations.NOI.Lawyer[i,2] = cor(cbind(dfRank.NOI.Lawyer[,i], dfRank.NOI.Lawyer$GDP) %>% na.omit())[2, 1]
correlations.NOI.EqPart[i,1] = cor(cbind(dfRank.NOI.EqPart[,i], dfRank.NOI.EqPart$AggMnA) %>% na.omit())[2, 1]
correlations.NOI.EqPart[i,2] = cor(cbind(dfRank.NOI.EqPart[,i], dfRank.NOI.EqPart$GDP) %>% na.omit())[2, 1]
}
colnames(correlations.Rev) <- c("AggMnA", "GDP")
colnames(correlations.Rev.Lawyer) <- c("AggMnA", "GDP")
colnames(correlations.Rev.EqPart) <- c("AggMnA", "GDP")
colnames(correlations.NOI) <- c("AggMnA", "GDP")
colnames(correlations.NOI.Lawyer) <- c("AggMnA", "GDP")
colnames(correlations.NOI.EqPart) <- c("AggMnA", "GDP")
correlations.Rev
correlations.Rev.EqPart
correlations.NOI
print(xtable(correlations.Rev), file="Generate Latex/IndivTexOutput/MnAGDP-GrossRevenue.tex")
print(xtable(correlations.Rev.Lawyer), file="Generate Latex/IndivTexOutput/MnAGDP-GrossRevenuePLawyer.tex")
print(xtable(correlations.Rev.EqPart), file="Generate Latex/IndivTexOutput/MnAGDP-GrossRevenuePEqPart.tex")
print(xtable(correlations.NOI), file="Generate Latex/IndivTexOutput/MnAGDP-NOI.tex")
print(xtable(correlations.NOI.Lawyer), file="Generate Latex/IndivTexOutput/MnAGDP-NOIPLawyer.tex")
print(xtable(correlations.NOI.EqPart), file="Generate Latex/IndivTexOutput/MnAGDP-NOIPEqPart.tex")
# This code opens the several linear regression results produced earlier
# And combine them in a way that can be easily written to LaTeX
rm(list = ls())
library(xtable)
library(dplyr)
library(ggplot2)
library(reshape)
library(GGally)
setwd("~/Google Drive/Stanford Law Project/Generate Latex/")
# Open files
load('RegressionsResults.RData')
load('../Data/EliteLawDf2016.RData')
source('GenerateLatex.R')
###################### Summary Statistics ######################
summaryTables <- GenerateSummaryStatistics(df)
for (i in 1:length(summaryTables)) {
print(xtable(summaryTables[[i]]), file=paste("IndivTexOutput/summary",i,".tex",sep=""), sanitize.text.function=function(x){x})
}
##################################################################
###################### Correlations ######################
# # get the correlations table
# corDF <- GenerateCorrelations(df)
# corDF <- round(cor(corDF),2)
# print(xtable(corDF), file="IndivTexOutput/corrTable.tex")
#
#
# # save the correlation heatmap
# heatmap <- ggplot(data = melt(corDF), aes(x=X1, y=X2, fill=value)) + geom_tile() +
#   xlab("") + ylab("") + ggtitle("Correlations HeatMap") +
#   labs(fill='Correlation')
# ggsave(file="IndivTexOutput/corrHeatmap.jpg", heatmap, width=8, height=5, dpi=300)
#
# # the ggpairs plot
# # Function to perform multiple plots with regressions
# ggpairs_with_linreg <- function(data, mapping, ...){
#   p <- ggplot(data = data, mapping = mapping) +
#     geom_point() +
#     geom_smooth(method=lm, fill="blue", color="red", ...)
#   return(p)
# }
#
#
#
# toPlot <- df[, c("Lawyers", "Leverage", "GrossRev", "NOI", "IPORevenue", "EquityRevenue",
#                  "MnARevenue", "GrossRev.Lawyer", "NOI.Lawyer", "NOI.eqPart")]
#
# labels <- names(toPlot)
# labels <- gsub("GrossRev", "Rev", labels)
# labels <- gsub(".eqPart", "/EqPart", labels)
# labels <- gsub(".Lawyer", "/Law", labels)
# labels <- gsub("Revenue", "", labels)
# labels <- gsub("MnA", "M&A", labels)
#
#
# graph <- ggpairs(toPlot, lower = list(continuous = ggpairs_with_linreg),
#       columnLabels=labels)
# ggsave(file="IndivTexOutput/corrGGpairs.jpg", graph, width=8, height=5, dpi=300)
##################################################################
###################### Regression Tables ######################
# Build the appropriate dataframes by slicing from the correct columns
Performance.Rev.Lawyer.With.Lawyers = resultsPerformance[, 1:9] # unused
# Set the possible Configurations
modelOutputs = c("GrossRev", "NOI", "NOI.eqPart", "GrossRev.eqPart")
outputDenominators = c("PerLawyer", "NoRatio")
excludeLawyers = c("WithLawyers2", "WithLawyersLog", "WithoutLawyers")
firmFixedEffects = c("FirmFE", "NoFirmFE", "Lawyers")
fixedEffects = c("FE3", "FE1", "FEYear", "NoFE")
dealsAndOrRevenues = c("Deals", "Revenue", "Both")
# we do the subtraction because NOI.eqPart should not have the PerLawyer attached to it.
numTables <- length(dealsAndOrRevenues)*length(modelOutputs)*length(outputDenominators)*length(excludeLawyers) -
2*length(excludeLawyers)*length(dealsAndOrRevenues)
dealsAndOrRevenue <- "Deals"
modelOutput <- "GrossRev"
outputDenominator <- "NoRatio"
excludeLawyer <- "WithLawyers2"
tables <- vector("list", numTables)
counter <- 1
for (dealsAndOrRevenue in dealsAndOrRevenues) {
# first subset
thisSubset1 <- names(resultsCoeffs)[grepl(dealsAndOrRevenue, names(resultsCoeffs))]
for (modelOutput in modelOutputs) {
thisSubset2 <- thisSubset1[grepl(modelOutput, thisSubset1)]
if (modelOutput == "NOI") {
# deselect all of the NOI.eqPart
thisSubset2 <- thisSubset2[!grepl("NOI.eqPart", thisSubset2)]
}
if (modelOutput == "GrossRev") {
# deselect all of the GrossRev.eqPart
thisSubset2 <- thisSubset2[!grepl("GrossRev.eqPart", thisSubset2)]
}
for (outputDenominator in outputDenominators) {
if (outputDenominator == "PerLawyer" && (modelOutput == "NOI.eqPart" || modelOutput == "GrossRev.eqPart")) {
next
}
thisSubset3 <- thisSubset2[grepl(outputDenominator, thisSubset2)]
for (excludeLawyer in excludeLawyers) {
thisSubset4 <- thisSubset3[grepl(excludeLawyer, thisSubset3)]
# STRICTLY DEBUGGING# STRICTLY DEBUGGING# STRICTLY DEBUGGING
dfCoeff = resultsCoeffs[, thisSubset4]
dfTValue = resultsTValues[, thisSubset4]
dfPValue = resultsPValues[, thisSubset4]
# STRICTLY DEBUGGING# STRICTLY DEBUGGING# STRICTLY DEBUGGING
thisTable <- GenerateLatexInference(resultsCoeffs[, thisSubset4], resultsTValues[, thisSubset4],
resultsPValues[, thisSubset4])
caption <- ""
if (modelOutput == "GrossRev") {
caption <- paste(caption, "Gross Revenue", sep="")
} else if (modelOutput == "NOI") {
caption <- paste(caption, "NOI", sep="")
} else if (modelOutput == "NOI.eqPart") {
caption <- paste(caption, "NOI/EquityPartner", sep="")
} else if (modelOutput == "GrossRev.eqPart") {
caption <- paste(caption, "GrossRevenue/EquityPartner", sep="")
}
if (outputDenominator == "PerLawyer" && modelOutput != "NOI.eqPart" && modelOutput != "GrossRev.eqPart") {
caption <- paste(caption, "/Lawyer", sep="")
}
if (dealsAndOrRevenue == "Both") {
caption <- paste(caption, " $\\sim$ Revenue + NumDeals", sep="")
} else {
caption <- paste(caption, " $\\sim$ ", dealsAndOrRevenue, sep="")
}
if (excludeLawyer == "WithoutLawyers") {
caption <- paste(caption, " (without Lawyers)", sep="")
} else if (excludeLawyer == "WithLawyers2") {
caption <- paste(caption, " (with Lawyers$^2$)", sep="")
} else if (excludeLawyer == "WithLawyersLog") {
caption <- paste(caption, " (with log(Lawyers))", sep="")
}
print(paste(dealsAndOrRevenue, modelOutput, outputDenominator, excludeLawyer, counter, caption))
tables[[counter]] <- xtable(thisTable, caption=caption)
counter <- counter + 1
}
}
}
}
# save all of the latex tables to files
for (i in 1:length(tables)) {
fileName <- paste("IndivTexOutput/regressions-table",i,".tex",sep="")
print(tables[[i]], file=fileName, sanitize.text.function=function(x){x})
}
